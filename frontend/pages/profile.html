<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetStyle - Mi Perfil</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%);
            padding: 60px 20px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        .logo {
            font-family: 'Poppins', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
        }

        .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 14px;
            font-weight: 300;
            position: relative;
            z-index: 2;
        }

        /* Profile Header */
        .profile-header {
            background: white;
            position: relative;
            z-index: 3;
            margin-top: -15px;
            border-radius: 20px 20px 0 0;
            padding: 30px 20px 20px;
            text-align: center;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 40px;
            color: white;
            position: relative;
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }

        .camera-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: white;
            border: 2px solid #8B5CF6;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .camera-btn:hover {
            background: #8B5CF6;
            color: white;
            transform: scale(1.1);
        }

        .profile-name {
            font-family: 'Poppins', sans-serif;
            font-size: 24px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .profile-email {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: rgba(139, 92, 246, 0.1);
            transform: translateY(-2px);
        }

        .stat-number {
            font-family: 'Poppins', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: #8B5CF6;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }

        /* Login CTA */
        .login-cta {
            background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            margin: 20px 0;
            color: white;
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }

        .login-cta h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .login-cta p {
            margin-bottom: 20px;
            opacity: 0.9;
            line-height: 1.5;
        }

        .login-btn, .register-btn {
            background: white;
            color: #8B5CF6;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            text-decoration: none;
            display: inline-block;
        }

        .login-btn:hover, .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .register-btn {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .register-btn:hover {
            background: white;
            color: #8B5CF6;
        }

        /* Content */
        .content {
            padding: 0 20px 120px;
        }

        /* Menu Items */
        .menu-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-family: 'Poppins', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 15px;
            padding-left: 5px;
        }

        .menu-item {
            background: white;
            border-radius: 15px;
            padding: 18px 20px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #f1f5f9;
        }

        .menu-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.15);
            border-color: #8B5CF6;
        }

        .menu-icon {
            width: 45px;
            height: 45px;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 15px;
            transition: all 0.3s ease;
        }

        .menu-item:hover .menu-icon {
            background: #8B5CF6;
            transform: scale(1.1);
        }

        .menu-item:hover .menu-icon,
        .menu-item:hover .menu-icon * {
            color: white !important;
        }

        .menu-content {
            flex: 1;
        }

        .menu-title {
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 2px;
        }

        .menu-subtitle {
            font-size: 12px;
            color: #6b7280;
        }

        .menu-arrow {
            color: #8B5CF6;
            font-size: 18px;
            margin-left: auto;
        }

        /* Switch Toggle */
        .switch {
            position: relative;
            width: 50px;
            height: 25px;
            margin-left: auto;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 25px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 19px;
            width: 19px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #8B5CF6;
        }

        input:checked + .slider:before {
            transform: translateX(25px);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 350px;
            border-radius: 25px;
            padding: 30px;
            transform: scale(0.7);
            animation: scaleIn 0.3s ease forwards;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-family: 'Poppins', sans-serif;
            font-size: 24px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            background: #f9fafb;
        }

        .form-input:focus {
            border-color: #8B5CF6;
            background: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .btn-primary, .btn-secondary {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #6b7280;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
            transform: translateY(-2px);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 12px;
        }

        .nav-item.active {
            background: rgba(139, 92, 246, 0.1);
            color: #8B5CF6;
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(180deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            to { transform: scale(1); }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .menu-item {
            animation: slideInUp 0.6s ease forwards;
        }

        .menu-item:nth-child(even) {
            animation-delay: 0.1s;
        }

        /* Hidden content */
        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .bottom-nav {
                max-width: 100%;
            }
        }

        /* Logout button */
        .logout-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            width: 100%;
            margin-top: 20px;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        /* Pet Profile Section */
        .pet-profile {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            color: white;
        }

        .pet-profile h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .pet-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .pet-card {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .pet-card:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .pet-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-size: 24px;
        }

        .add-pet {
            border: 2px dashed rgba(255,255,255,0.5);
            background: transparent;
        }

        .add-pet .pet-avatar {
            border: 2px dashed rgba(255,255,255,0.5);
            background: transparent;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="logo">PetStyle</h1>
            <p class="subtitle">Tu perfil personalizado</p>
        </div>

        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar" id="profileAvatar">
                👤
                <div class="camera-btn" onclick="changeAvatar()" style="display: none;" id="cameraBtn">📷</div>
            </div>
            <div class="profile-name" id="profileName">Invitado</div>
            <div class="profile-email" id="profileEmail">Inicia sesión para personalizar tu experiencia</div>
            
            <!-- User Stats (Only for logged in users) -->
            <div class="stats-grid hidden" id="userStats">
                <div class="stat-item">
                    <div class="stat-number" id="ordersCount">0</div>
                    <div class="stat-label">Pedidos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="favoritesCount">0</div>
                    <div class="stat-label">Favoritos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="reviewsCount">0</div>
                    <div class="stat-label">Reseñas</div>
                </div>
            </div>

            <!-- Login CTA (Only for guests) -->
            <div class="login-cta" id="loginCTA">
                <h3>¡Únete a PetStyle!</h3>
                <p>Crea tu cuenta para acceder a ofertas exclusivas, historial de pedidos y mucho más.</p>
                <a href="login.html" class="login-btn">Iniciar Sesión</a>
                <a href="register.html" class="register-btn">Crear Cuenta</a>
            </div>

            <!-- Pet Profiles (Only for logged in users) -->
            <div class="pet-profile hidden" id="petProfile">
                <h3>🐾 Mis Mascotas</h3>
                <div class="pet-grid" id="petGrid">
                    <div class="pet-card add-pet" onclick="openAddPetModal()">
                        <div class="pet-avatar">+</div>
                        <div>Agregar Mascota</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- Account Section (For logged in users) -->
            <div class="menu-section hidden" id="accountSection">
                <h2 class="section-title">Mi Cuenta</h2>
                
                <div class="menu-item" onclick="openEditProfileModal()">
                    <div class="menu-icon">👤</div>
                    <div class="menu-content">
                        <div class="menu-title">Información Personal</div>
                        <div class="menu-subtitle">Edita tu perfil y datos personales</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="openAddressModal()">
                    <div class="menu-icon">📍</div>
                    <div class="menu-content">
                        <div class="menu-title">Direcciones</div>
                        <div class="menu-subtitle">Gestiona tus direcciones de envío</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="openPaymentModal()">
                    <div class="menu-icon">💳</div>
                    <div class="menu-content">
                        <div class="menu-title">Métodos de Pago</div>
                        <div class="menu-subtitle">Tarjetas y formas de pago</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="showOrderHistory()">
                    <div class="menu-icon">📦</div>
                    <div class="menu-content">
                        <div class="menu-title">Historial de Pedidos</div>
                        <div class="menu-subtitle">Revisa tus compras anteriores</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>
            </div>

            <!-- App Settings -->
            <div class="menu-section">
                <h2 class="section-title">Configuración</h2>
                
                <div class="menu-item">
                    <div class="menu-icon">🔔</div>
                    <div class="menu-content">
                        <div class="menu-title">Notificaciones</div>
                        <div class="menu-subtitle">Recibe alertas de ofertas y pedidos</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="notificationsToggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="menu-item">
                    <div class="menu-icon">🌙</div>
                    <div class="menu-content">
                        <div class="menu-title">Modo Oscuro</div>
                        <div class="menu-subtitle">Cambia el tema de la aplicación</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="menu-item" onclick="openLanguageModal()">
                    <div class="menu-icon">🌍</div>
                    <div class="menu-content">
                        <div class="menu-title">Idioma</div>
                        <div class="menu-subtitle">Español</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="openCurrencyModal()">
                    <div class="menu-icon">💰</div>
                    <div class="menu-content">
                        <div class="menu-title">Moneda</div>
                        <div class="menu-subtitle">USD - Dólar Americano</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>
            </div>

            <!-- Support -->
            <div class="menu-section">
                <h2 class="section-title">Soporte</h2>
                
                <div class="menu-item" onclick="openHelpCenter()">
                    <div class="menu-icon">❓</div>
                    <div class="menu-content">
                        <div class="menu-title">Centro de Ayuda</div>
                        <div class="menu-subtitle">Preguntas frecuentes y guías</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="contactSupport()">
                    <div class="menu-icon">💬</div>
                    <div class="menu-content">
                        <div class="menu-title">Contactar Soporte</div>
                        <div class="menu-subtitle">Chat en vivo y asistencia</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>

                <div class="menu-item" onclick="showAbout()">
                    <div class="menu-icon">ℹ️</div>
                    <div class="menu-content">
                        <div class="menu-title">Acerca de PetStyle</div>
                        <div class="menu-subtitle">Versión 2.1.0</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>
            </div>

            <!-- Logout Button (Only for logged in users) -->
            <div class="menu-section hidden" id="logoutSection">
                <button class="logout-btn" onclick="logout()">Cerrar Sesión</button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item" onclick="navigateTo('main.html')">
                <div class="nav-icon">🏠</div>
                <div class="nav-label">Inicio</div>
            </div>
            <div class="nav-item" onclick="navigateTo('favorites.html')">
                <div class="nav-icon">❤️</div>
                <div class="nav-label">Favoritos</div>
            </div>
            <div class="nav-item" onclick="navigateTo('carrito.html')" style="position: relative;">
                <div class="nav-icon">🛒</div>
                <div class="nav-label">Carrito</div>
                <div class="cart-badge" id="cartBadge">0</div>
            </div>
            <div class="nav-item active">
                <div class="nav-icon">👤</div>
                <div class="nav-label">Perfil</div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Editar Perfil</div>
            </div>
            <form id="editProfileForm">
                <div class="form-group">
                    <label class="form-label">Nombre Completo</label>
                    <input type="text" class="form-input" id="editName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="editEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Teléfono</label>
                    <input type="tel" class="form-input" id="editPhone">
                </div>
                <div class="form-group">
                    <label class="form-label">Fecha de Nacimiento</label>
                    <input type="date" class="form-input" id="editBirthdate">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-secondary" onclick="closeModal('editProfileModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Pet Modal -->
    <div class="modal" id="addPetModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Agregar Mascota</div>
            </div>
            <form id="addPetForm">
                <div class="form-group">
                    <label class="form-label">Nombre de la Mascota</label>
                    <input type="text" class="form-input" id="petName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Tipo</label>
                    <select class="form-input" id="petType" required>
                        <option value="">Seleccionar tipo</option>
                        <option value="dog">🐕 Perro</option>
                        <option value="cat">🐱 Gato</option>
                        <option value="bird">🐦 Ave</option>
                        <option value="rabbit">🐰 Conejo</option>
                        <option value="hamster">🐹 Hámster</option>
                        <option value="fish">🐠 Pez</option>
                        <option value="other">🐾 Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Raza</label>
                    <input type="text" class="form-input" id="petBreed">
                </div>
                <div class="form-group">
                    <label class="form-label">Edad</label>
                    <input type="number" class="form-input" id="petAge" min="0" max="30">
                </div>
                <div class="form-group">
                    <label class="form-label">Peso (kg)</label>
                    <input type="number" class="form-input" id="petWeight" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Notas Especiales</label>
                    <textarea class="form-input form-textarea" id="petNotes" placeholder="Alergias, preferencias, cuidados especiales..."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-secondary" onclick="closeModal('addPetModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Agregar Mascota</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Address Modal -->
    <div class="modal" id="addressModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Gestionar Direcciones</div>
            </div>
            <div id="addressList">
                <div class="menu-item" onclick="openAddAddressModal()">
                    <div class="menu-icon">➕</div>
                    <div class="menu-content">
                        <div class="menu-title">Agregar Nueva Dirección</div>
                        <div class="menu-subtitle">Casa, trabajo, etc.</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn-secondary" onclick="closeModal('addressModal')">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Add Address Modal -->
    <div class="modal" id="addAddressModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Nueva Dirección</div>
            </div>
            <form id="addAddressForm">
                <div class="form-group">
                    <label class="form-label">Etiqueta</label>
                    <select class="form-input" id="addressLabel" required>
                        <option value="">Seleccionar etiqueta</option>
                        <option value="home">🏠 Casa</option>
                        <option value="work">🏢 Trabajo</option>
                        <option value="other">📍 Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Nombre del Destinatario</label>
                    <input type="text" class="form-input" id="recipientName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Dirección</label>
                    <input type="text" class="form-input" id="addressStreet" placeholder="Calle y número" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ciudad</label>
                    <input type="text" class="form-input" id="addressCity" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Código Postal</label>
                    <input type="text" class="form-input" id="addressZip" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Teléfono de Contacto</label>
                    <input type="tel" class="form-input" id="addressPhone">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-secondary" onclick="closeModal('addAddressModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar Dirección</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Métodos de Pago</div>
            </div>
            <div id="paymentList">
                <div class="menu-item" onclick="openAddPaymentModal()">
                    <div class="menu-icon">➕</div>
                    <div class="menu-content">
                        <div class="menu-title">Agregar Tarjeta</div>
                        <div class="menu-subtitle">Visa, Mastercard, etc.</div>
                    </div>
                    <div class="menu-arrow">›</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn-secondary" onclick="closeModal('paymentModal')">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Add Payment Modal -->
    <div class="modal" id="addPaymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Nueva Tarjeta</div>
            </div>
            <form id="addPaymentForm">
                <div class="form-group">
                    <label class="form-label">Número de Tarjeta</label>
                    <input type="text" class="form-input" id="cardNumber" placeholder="1234 5678 9012 3456" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Nombre en la Tarjeta</label>
                    <input type="text" class="form-input" id="cardName" required>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label class="form-label">Fecha de Expiración</label>
                        <input type="text" class="form-input" id="cardExpiry" placeholder="MM/AA" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">CVV</label>
                        <input type="text" class="form-input" id="cardCVV" placeholder="123" maxlength="4" required>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-secondary" onclick="closeModal('addPaymentModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Agregar Tarjeta</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Language Modal -->
    <div class="modal" id="languageModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Seleccionar Idioma</div>
            </div>
            <div>
                <div class="menu-item" onclick="changeLanguage('es')">
                    <div class="menu-icon">🇪🇸</div>
                    <div class="menu-content">
                        <div class="menu-title">Español</div>
                    </div>
                    <div class="menu-arrow" id="lang-es">✓</div>
                </div>
                <div class="menu-item" onclick="changeLanguage('en')">
                    <div class="menu-icon">🇺🇸</div>
                    <div class="menu-content">
                        <div class="menu-title">English</div>
                    </div>
                    <div class="menu-arrow" id="lang-en"></div>
                </div>
                <div class="menu-item" onclick="changeLanguage('pt')">
                    <div class="menu-icon">🇧🇷</div>
                    <div class="menu-content">
                        <div class="menu-title">Português</div>
                    </div>
                    <div class="menu-arrow" id="lang-pt"></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn-secondary" onclick="closeModal('languageModal')">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Currency Modal -->
    <div class="modal" id="currencyModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Seleccionar Moneda</div>
            </div>
            <div>
                <div class="menu-item" onclick="changeCurrency('USD')">
                    <div class="menu-icon">💵</div>
                    <div class="menu-content">
                        <div class="menu-title">USD - Dólar Americano</div>
                    </div>
                    <div class="menu-arrow" id="curr-USD">✓</div>
                </div>
                <div class="menu-item" onclick="changeCurrency('MXN')">
                    <div class="menu-icon">🇲🇽</div>
                    <div class="menu-content">
                        <div class="menu-title">MXN - Peso Mexicano</div>
                    </div>
                    <div class="menu-arrow" id="curr-MXN"></div>
                </div>
                <div class="menu-item" onclick="changeCurrency('EUR')">
                    <div class="menu-icon">💶</div>
                    <div class="menu-content">
                        <div class="menu-title">EUR - Euro</div>
                    </div>
                    <div class="menu-arrow" id="curr-EUR"></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn-secondary" onclick="closeModal('currencyModal')">Cerrar</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let userToken = null;
        let userData = {
            name: '',
            email: '',
            phone: '',
            birthdate: '',
            avatar: '👤',
            pets: [],
            addresses: [],
            paymentMethods: [],
            orders: [],
            settings: {
                notifications: true,
                darkMode: false,
                language: 'es',
                currency: 'USD'
            }
        };

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadUserData();
            updateCartBadge();
            setupEventListeners();
        });

        // Check if user is authenticated
        function checkAuthStatus() {
            // Check for auth token from localStorage or from URL params (after login redirect)
            userToken = getUserToken();
            
            if (userToken) {
                showAuthenticatedView();
            } else {
                showGuestView();
            }
        }

        // Get user token from storage
        function getUserToken() {
            // Try to get token from localStorage (real implementation)
            if (typeof(Storage) !== "undefined") {
                const token = localStorage.getItem('petStyle_authToken');
                if (token) {
                    return token;
                }
            }
            
            // Check URL parameters for token (in case of redirect from login)
            const urlParams = new URLSearchParams(window.location.search);
            const urlToken = urlParams.get('token');
            if (urlToken) {
                // Save token to localStorage and clean URL
                if (typeof(Storage) !== "undefined") {
                    localStorage.setItem('petStyle_authToken', urlToken);
                }
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
                return urlToken;
            }
            
            return null;
        }

        // Save user token
        function saveUserToken(token) {
            if (typeof(Storage) !== "undefined") {
                localStorage.setItem('petStyle_authToken', token);
            }
        }

        // Remove user token
        function removeUserToken() {
            if (typeof(Storage) !== "undefined") {
                localStorage.removeItem('petStyle_authToken');
                localStorage.removeItem('petStyle_userData');
            }
        }

        // Load user data
        function loadUserData() {
            if (typeof(Storage) !== "undefined") {
                const storedData = localStorage.getItem('petStyle_userData');
                if (storedData) {
                    try {
                        const parsedData = JSON.parse(storedData);
                        userData = { ...userData, ...parsedData };
                        updateUserInterface();
                    } catch (e) {
                        console.error('Error parsing stored user data:', e);
                    }
                }
            }
        }

        // Save user data
        function saveUserData() {
            if (typeof(Storage) !== "undefined") {
                localStorage.setItem('petStyle_userData', JSON.stringify(userData));
            }
        }

        // Show authenticated user view
        function showAuthenticatedView() {
            // Hide guest elements
            document.getElementById('loginCTA').classList.add('hidden');
            
            // Show authenticated elements
            document.getElementById('userStats').classList.remove('hidden');
            document.getElementById('petProfile').classList.remove('hidden');
            document.getElementById('accountSection').classList.remove('hidden');
            document.getElementById('logoutSection').classList.remove('hidden');
            document.getElementById('cameraBtn').style.display = 'flex';
            
            // Load user profile from backend (simulated)
            loadUserProfile();
            
            updateUserStats();
            renderPets();
        }

        // Show guest view
        function showGuestView() {
            // Show guest elements
            document.getElementById('loginCTA').classList.remove('hidden');
            
            // Hide authenticated elements
            document.getElementById('userStats').classList.add('hidden');
            document.getElementById('petProfile').classList.add('hidden');
            document.getElementById('accountSection').classList.add('hidden');
            document.getElementById('logoutSection').classList.add('hidden');
            document.getElementById('cameraBtn').style.display = 'none';
            
            // Reset profile info
            document.getElementById('profileName').textContent = 'Invitado';
            document.getElementById('profileEmail').textContent = 'Inicia sesión para personalizar tu experiencia';
            document.getElementById('profileAvatar').innerHTML = '👤<div class="camera-btn" onclick="changeAvatar()" style="display: none;" id="cameraBtn">📷</div>';
        }

        // Load user profile from backend (placeholder for real implementation)
        async function loadUserProfile() {
            try {
                // This would be a real API call to your backend
                // const response = await fetch('/api/user/profile', {
                //     headers: {
                //         'Authorization': `Bearer ${userToken}`
                //     }
                // });
                // const profileData = await response.json();
                
                // For demo purposes, simulate loading user data
                if (!userData.name) {
                    userData.name = 'María González';
                    userData.email = 'maria@petstyle.com';
                    userData.phone = '+52 123 456 7890';
                    saveUserData();
                }
                
                // Update UI with loaded data
                document.getElementById('profileName').textContent = userData.name;
                document.getElementById('profileEmail').textContent = userData.email;
                updateUserInterface();
                
            } catch (error) {
                console.error('Error loading user profile:', error);
                showToast('Error al cargar el perfil');
            }
        }

        // Update user interface
        function updateUserInterface() {
            if (userData.avatar) {
                document.getElementById('profileAvatar').innerHTML = `${userData.avatar}<div class="camera-btn" onclick="changeAvatar()" id="cameraBtn">📷</div>`;
            }
        }

        // Update user stats
        function updateUserStats() {
            document.getElementById('ordersCount').textContent = userData.orders.length || Math.floor(Math.random() * 20 + 5);
            
            // Get favorites from localStorage if available
            let favoritesCount = 0;
            if (typeof(Storage) !== "undefined") {
                const favorites = localStorage.getItem('petStyle_favorites');
                if (favorites) {
                    try {
                        favoritesCount = JSON.parse(favorites).length;
                    } catch (e) {
                        favoritesCount = Math.floor(Math.random() * 15 + 3);
                    }
                } else {
                    favoritesCount = Math.floor(Math.random() * 15 + 3);
                }
            }
            
            document.getElementById('favoritesCount').textContent = favoritesCount;
            document.getElementById('reviewsCount').textContent = Math.floor(Math.random() * 25 + 8);
        }

        // Setup event listeners
        function setupEventListeners() {
            // Settings toggles
            document.getElementById('notificationsToggle').addEventListener('change', function() {
                userData.settings.notifications = this.checked;
                saveUserData();
                showToast(this.checked ? 'Notificaciones activadas' : 'Notificaciones desactivadas');
            });

            document.getElementById('darkModeToggle').addEventListener('change', function() {
                userData.settings.darkMode = this.checked;
                saveUserData();
                toggleDarkMode(this.checked);
                showToast(this.checked ? 'Modo oscuro activado' : 'Modo oscuro desactivado');
            });

            // Form submissions
            document.getElementById('editProfileForm').addEventListener('submit', handleEditProfile);
            document.getElementById('addPetForm').addEventListener('submit', handleAddPet);
            document.getElementById('addAddressForm').addEventListener('submit', handleAddAddress);
            document.getElementById('addPaymentForm').addEventListener('submit', handleAddPayment);

            // Modal click outside to close
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeModal(this.id);
                    }
                });
            });
            
            // Load settings from stored data
            if (userData.settings) {
                document.getElementById('notificationsToggle').checked = userData.settings.notifications;
                document.getElementById('darkModeToggle').checked = userData.settings.darkMode;
                if (userData.settings.darkMode) {
                    toggleDarkMode(true);
                }
            }
        }

        // Modal functions
        function openEditProfileModal() {
            if (!userToken) {
                showToast('Debes iniciar sesión para acceder a esta función');
                return;
            }
            
            document.getElementById('editName').value = userData.name || '';
            document.getElementById('editEmail').value = userData.email || '';
            document.getElementById('editPhone').value = userData.phone || '';
            document.getElementById('editBirthdate').value = userData.birthdate || '';
            
            document.getElementById('editProfileModal').classList.add('active');
        }

        function openAddPetModal() {
            if (!userToken) {
                showToast('Debes iniciar sesión para acceder a esta función');
                return;
            }
            document.getElementById('addPetModal').classList.add('active');
        }

        function openAddressModal() {
            if (!userToken) {
                showToast('Debes iniciar sesión para acceder a esta función');
                return;
            }
            renderAddresses();
            document.getElementById('addressModal').classList.add('active');
        }

        function openAddAddressModal() {
            document.getElementById('addAddressModal').classList.add('active');
        }

        function openPaymentModal() {
            if (!userToken) {
                showToast('Debes iniciar sesión para acceder a esta función');
                return;
            }
            renderPaymentMethods();
            document.getElementById('paymentModal').classList.add('active');
        }

        function openAddPaymentModal() {
            document.getElementById('addPaymentModal').classList.add('active');
        }

        function openLanguageModal() {
            document.getElementById('languageModal').classList.add('active');
        }

        function openCurrencyModal() {
            document.getElementById('currencyModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Form handlers
        function handleEditProfile(e) {
            e.preventDefault();
            
            userData.name = document.getElementById('editName').value;
            userData.email = document.getElementById('editEmail').value;
            userData.phone = document.getElementById('editPhone').value;
            userData.birthdate = document.getElementById('editBirthdate').value;
            
            saveUserData();
            updateUserInterface();
            
            document.getElementById('profileName').textContent = userData.name;
            document.getElementById('profileEmail').textContent = userData.email;
            
            closeModal('editProfileModal');
            showToast('Perfil actualizado correctamente');
            
            // Here you would send the data to your backend
            // updateProfileOnBackend(userData);
        }

        function handleAddPet(e) {
            e.preventDefault();
            
            const petData = {
                id: Date.now(),
                name: document.getElementById('petName').value,
                type: document.getElementById('petType').value,
                breed: document.getElementById('petBreed').value,
                age: document.getElementById('petAge').value,
                weight: document.getElementById('petWeight').value,
                notes: document.getElementById('petNotes').value
            };
            
            userData.pets.push(petData);
            saveUserData();
            renderPets();
            
            document.getElementById('addPetForm').reset();
            closeModal('addPetModal');
            showToast(`¡${petData.name} agregado a tu perfil!`);
            
            // Here you would send the pet data to your backend
            // addPetToBackend(petData);
        }

        function handleAddAddress(e) {
            e.preventDefault();
            
            const addressData = {
                id: Date.now(),
                label: document.getElementById('addressLabel').value,
                recipientName: document.getElementById('recipientName').value,
                street: document.getElementById('addressStreet').value,
                city: document.getElementById('addressCity').value,
                zip: document.getElementById('addressZip').value,
                phone: document.getElementById('addressPhone').value
            };
            
            userData.addresses.push(addressData);
            saveUserData();
            renderAddresses();
            
            document.getElementById('addAddressForm').reset();
            closeModal('addAddressModal');
            showToast('Dirección agregada correctamente');
            
            // Here you would send the address data to your backend
            // addAddressToBackend(addressData);
        }

        function handleAddPayment(e) {
            e.preventDefault();
            
            const cardNumber = document.getElementById('cardNumber').value;
            const paymentData = {
                id: Date.now(),
                number: '**** **** **** ' + cardNumber.slice(-4),
                name: document.getElementById('cardName').value,
                expiry: document.getElementById('cardExpiry').value,
                type: getCardType(cardNumber)
            };
            
            userData.paymentMethods.push(paymentData);
            saveUserData();
            renderPaymentMethods();
            
            document.getElementById('addPaymentForm').reset();
            closeModal('addPaymentModal');
            showToast('Tarjeta agregada correctamente');
            
            // Here you would send the payment data to your backend (securely)
            // addPaymentMethodToBackend(paymentData);
        }

        // Render functions
        function renderPets() {
            const petGrid = document.getElementById('petGrid');
            const addPetButton = petGrid.querySelector('.add-pet');
            
            // Clear existing pets (except add button)
            petGrid.innerHTML = '';
            petGrid.appendChild(addPetButton);
            
            userData.pets.forEach(pet => {
                const petCard = document.createElement('div');
                petCard.className = 'pet-card';
                petCard.onclick = () => editPet(pet.id);
                
                const emoji = getPetEmoji(pet.type);
                
                petCard.innerHTML = `
                    <div class="pet-avatar">${emoji}</div>
                    <div style="font-weight: 600;">${pet.name}</div>
                    <div style="font-size: 12px; opacity: 0.8;">${pet.breed || pet.type}</div>
                `;
                
                petGrid.insertBefore(petCard, addPetButton);
            });
        }

        function renderAddresses() {
            const addressList = document.getElementById('addressList');
            const addButton = addressList.querySelector('.menu-item');
            
            // Clear existing addresses (except add button)
            addressList.innerHTML = '';
            addressList.appendChild(addButton);
            
            userData.addresses.forEach(address => {
                const addressItem = document.createElement('div');
                addressItem.className = 'menu-item';
                addressItem.onclick = () => editAddress(address.id);
                
                const labelEmoji = address.label === 'home' ? '🏠' : address.label === 'work' ? '🏢' : '📍';
                
                addressItem.innerHTML = `
                    <div class="menu-icon">${labelEmoji}</div>
                    <div class="menu-content">
                        <div class="menu-title">${address.recipientName}</div>
                        <div class="menu-subtitle">${address.street}, ${address.city}</div>
                    </div>
                    <div class="menu-arrow">›</div>
                `;
                
                addressList.appendChild(addressItem);
            });
        }

        function renderPaymentMethods() {
            const paymentList = document.getElementById('paymentList');
            const addButton = paymentList.querySelector('.menu-item');
            
            // Clear existing payments (except add button)
            paymentList.innerHTML = '';
            paymentList.appendChild(addButton);
            
            userData.paymentMethods.forEach(payment => {
                const paymentItem = document.createElement('div');
                paymentItem.className = 'menu-item';
                paymentItem.onclick = () => editPayment(payment.id);
                
                paymentItem.innerHTML = `
                    <div class="menu-icon">💳</div>
                    <div class="menu-content">
                        <div class="menu-title">${payment.type} ${payment.number}</div>
                        <div class="menu-subtitle">${payment.name} • Exp. ${payment.expiry}</div>
                    </div>
                    <div class="menu-arrow">›</div>
                `;
                
                paymentList.appendChild(paymentItem);
            });
        }

        // Utility functions
        function getPetEmoji(type) {
            const emojis = {
                dog: '🐕',
                cat: '🐱',
                bird: '🐦',
                rabbit: '🐰',
                hamster: '🐹',
                fish: '🐠',
                other: '🐾'
            };
            return emojis[type] || '🐾';
        }

        function getCardType(number) {
            if (number.startsWith('4')) return 'Visa';
            if (number.startsWith('5')) return 'Mastercard';
            if (number.startsWith('3')) return 'Amex';
            return 'Tarjeta';
        }

        // Settings functions
        function changeLanguage(lang) {
            userData.settings.language = lang;
            saveUserData();
            
            // Update UI to show selected language
            document.querySelectorAll('[id^="lang-"]').forEach(el => el.textContent = '');
            document.getElementById(`lang-${lang}`).textContent = '✓';
            
            // Update language display
            const languages = { es: 'Español', en: 'English', pt: 'Português' };
            document.querySelector('[onclick="openLanguageModal()"] .menu-subtitle').textContent = languages[lang];
            
            closeModal('languageModal');
            showToast(`Idioma cambiado a ${languages[lang]}`);
        }

        function changeCurrency(currency) {
            userData.settings.currency = currency;
            saveUserData();
            
            // Update UI to show selected currency
            document.querySelectorAll('[id^="curr-"]').forEach(el => el.textContent = '');
            document.getElementById(`curr-${currency}`).textContent = '✓';
            
            // Update currency display
            const currencies = { 
                USD: 'USD - Dólar Americano', 
                MXN: 'MXN - Peso Mexicano', 
                EUR: 'EUR - Euro' 
            };
            document.querySelector('[onclick="openCurrencyModal()"] .menu-subtitle').textContent = currencies[currency];
            
            closeModal('currencyModal');
            showToast(`Moneda cambiada a ${currency}`);
        }

        function toggleDarkMode(enabled) {
            if (enabled) {
                document.body.style.filter = 'invert(1) hue-rotate(180deg)';
                document.querySelectorAll('img').forEach(img => {
                    img.style.filter = 'invert(1) hue-rotate(180deg)';
                });
            } else {
                document.body.style.filter = '';
                document.querySelectorAll('img').forEach(img => {
                    img.style.filter = '';
                });
            }
        }

        // Avatar functions
        function changeAvatar() {
            if (!userToken) {
                showToast('Debes iniciar sesión para cambiar tu avatar');
                return;
            }
            
            const avatars = ['👤', '👨', '👩', '🧑', '👦', '👧', '🐶', '🐱', '🐰', '🦊'];
            const currentIndex = avatars.indexOf(userData.avatar);
            const nextIndex = (currentIndex + 1) % avatars.length;
            
            userData.avatar = avatars[nextIndex];
            saveUserData();
            updateUserInterface();
            showToast('Avatar actualizado');
        }

        // Action functions
        function editPet(petId) {
            // Implementation for editing pet
            showToast('Función de edición próximamente');
        }

        function editAddress(addressId) {
            // Implementation for editing address
            showToast('Función de edición próximamente');
        }

        function editPayment(paymentId) {
            // Implementation for editing payment
            showToast('Función de edición próximamente');
        }

        function showOrderHistory() {
            showToast('Historial de pedidos próximamente');
        }

        function openHelpCenter() {
            showToast('Centro de ayuda próximamente');
        }

        function contactSupport() {
            showToast('Contactando soporte...');
        }

        function showAbout() {
            showToast('PetStyle v2.1.0 - Hecho con ❤️ para las mascotas');
        }

        // Auth functions
        function logout() {
            userToken = null;
            userData = {
                name: '',
                email: '',
                phone: '',
                birthdate: '',
                avatar: '👤',
                pets: [],
                addresses: [],
                paymentMethods: [],
                orders: [],
                settings: {
                    notifications: true,
                    darkMode: false,
                    language: 'es',
                    currency: 'USD'
                }
            };
            
            // Clear stored data
            removeUserToken();
            
            showGuestView();
            showToast('Sesión cerrada correctamente');
        }

        // Navigation functions
        function navigateTo(page) {
            // Simple navigation - in a real app you might use a router
            window.location.href = page;
        }

        // Cart functions
        function updateCartBadge() {
            let cartCount = 0;
            if (typeof(Storage) !== "undefined") {
                const cart = localStorage.getItem('petStyle_cart');
                if (cart) {
                    try {
                        cartCount = JSON.parse(cart).length;
                    } catch (e) {
                        cartCount = 0;
                    }
                }
            }
            document.getElementById('cartBadge').textContent = cartCount;
        }

        // Toast notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #059669;
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                font-weight: 500;
                z-index: 1001;
                animation: slideInUp 0.3s ease;
                max-width: 300px;
                text-align: center;
                box-shadow: 0 8px 25px rgba(5, 150, 105, 0.3);
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'fadeIn 0.3s ease reverse';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 2500);
        }

        // API integration placeholders (for when you connect to backend)
        
        // Login with backend
        async function loginWithBackend(credentials) {
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(credentials)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    userToken = data.token;
                    saveUserToken(userToken);
                    showAuthenticatedView();
                    return true;
                } else {
                    throw new Error('Login failed');
                }
            } catch (error) {
                console.error('Login error:', error);
                showToast('Error al iniciar sesión');
                return false;
            }
        }

        // Update profile on backend
        async function updateProfileOnBackend(profileData) {
            try {
                const response = await fetch('/api/user/profile', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify(profileData)
                });
                
                if (!response.ok) {
                    throw new Error('Profile update failed');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Profile update error:', error);
                showToast('Error al actualizar perfil');
            }
        }

        // Add pet to backend
        async function addPetToBackend(petData) {
            try {
                const response = await fetch('/api/user/pets', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify(petData)
                });
                
                if (!response.ok) {
                    throw new Error('Add pet failed');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Add pet error:', error);
                showToast('Error al agregar mascota');
            }
        }

        // Add address to backend
        async function addAddressToBackend(addressData) {
            try {
                const response = await fetch('/api/user/addresses', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify(addressData)
                });
                
                if (!response.ok) {
                    throw new Error('Add address failed');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Add address error:', error);
                showToast('Error al agregar dirección');
            }
        }

        // Add payment method to backend
        async function addPaymentMethodToBackend(paymentData) {
            try {
                // Note: In a real implementation, you should never send full card details to your backend
                // Use a secure payment processor like Stripe, PayPal, etc.
                const response = await fetch('/api/user/payment-methods', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify({
                        // Only send secure/tokenized payment info
                        cardToken: paymentData.token, // Token from payment processor
                        lastFour: paymentData.number.slice(-4),
                        type: paymentData.type,
                        expiry: paymentData.expiry
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Add payment method failed');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Add payment method error:', error);
                showToast('Error al agregar método de pago');
            }
        }

        // Validate token with backend
        async function validateTokenWithBackend(token) {
            try {
                const response = await fetch('/api/auth/validate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                return response.ok;
            } catch (error) {
                console.error('Token validation error:', error);
                return false;
            }
        }

        // Auto-refresh token functionality
        function setupTokenRefresh() {
            if (userToken) {
                // Refresh token every 50 minutes (if your tokens expire in 1 hour)
                setInterval(async () => {
                    try {
                        const response = await fetch('/api/auth/refresh', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${userToken}`
                            }
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            userToken = data.token;
                            saveUserToken(userToken);
                        } else {
                            // Token refresh failed, logout user
                            logout();
                        }
                    } catch (error) {
                        console.error('Token refresh error:', error);
                    }
                }, 50 * 60 * 1000); // 50 minutes
            }
        }

        // Initialize token refresh when user is authenticated
        if (userToken) {
            setupTokenRefresh();
        }
    </script>
</body>
</html>